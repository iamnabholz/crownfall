import{j as k}from"./kaplay-DbgAWYSR.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();function O(){e.loadRoot("./"),e.loadBitmapFont("Alkhemikal","fonts/Alkhemikal.png",24,32,{filter:"nearest",chars:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"}),e.loadBitmapFont("NameHere","fonts/NameHere.png",24,32,{filter:"nearest",chars:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"}),e.loadBitmapFont("Numbers","fonts/Number.png",30,30,{filter:"nearest",chars:" #$%'()*+,-./0123456789:<=>"}),e.loadBitmapFont("Classic","fonts/ClassicShit.png",30,30,{filter:"nearest",chars:" !&'()*+,.0123456789:;=?ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"}),e.loadFont("Menu","fonts/MenuCard.ttf"),e.loadSprite("TITLE","sprites/title.png")}function f(t=48){let r=t;const a=128,s=e.height(),n=e.height()-r*2;if(n>a){const o=n-a;r=r+o/2}return console.log(s,n,r),r}const e=k({global:!1,scale:4,font:"NameHere",crisp:!0,texFilter:"nearest",loadingScreen:!0,background:[10,10,20],debug:!0,buttons:{primary:{keyboard:["x","up"],gamepad:["south"],mouse:["left"]},secondary:{keyboard:["z","left"],gamepad:["west"],mouse:["right"]}}}),i={difficulty:"easy",mode:"start",score:0,highscore:0,yOffset:f(),xOffset:72,xPosition:e.center().x,spacing:6,tintColor:[244,78,56]};e.onResize(()=>{i.yOffset=f(),i.xPosition=e.center().x});O();e.loadShader("tint",null,`
  uniform vec3 u_color;

  vec4 frag(vec2 pos, vec2 uv, vec4 color, sampler2D tex) {
      vec4 c = def_frag();
      return vec4(u_color.x * c.r,
        u_color.y * c.g,
        u_color.z * c.b,
        c.a);
  }
`);const p=[[139,200,254],[207,171,74],[244,78,56],[0,255,174],[166,146,176]],h=[];function S(){const t=p.map((o,c)=>c).filter(o=>!h.includes(o)),r=t[Math.floor(Math.random()*t.length)];h.push(r),h.length>2&&h.shift(),i.tintColor=p[r];const[a,s,n]=p[r].map(o=>o/255);e.usePostEffect("tint",()=>({u_color:e.rgb(a,s,n)}))}S();e.onLoading(t=>{e.randSeed(Date.now()),e.drawText({text:(Math.floor(t)+" %").toString(),size:10,width:120,anchor:"center",align:"center",letterSpacing:-2,pos:e.center(),color:e.WHITE})});e.scene("over",()=>{e.add([e.sprite("restart"),e.pos(e.center().x,e.center().y+48),e.anchor("center"),e.area(),"restart"]),i.score>i.highscore&&(i.highscore=i.score),e.onClick("restart",()=>{i.score=0,i.mode="start",e.go("game")}),e.onDraw(()=>{e.drawSprite({sprite:"RIP",width:24,height:24,pos:e.vec2(e.center().x,e.center().y-64),anchor:"center"}),e.drawText({text:"GAME OVER",font:"Alkhemikal",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y-26),letterSpacing:-4,size:28}),e.drawText({text:"Score: "+i.score,anchor:"center",align:"center",pos:e.center(),letterSpacing:-5,size:16}),e.drawText({text:"Highscore: "+i.highscore,anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+16),letterSpacing:-5,size:16}),e.drawText({text:"by FABRIC VISIONS",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.height()-10),letterSpacing:-2.8,size:8,opacity:.4})})});function y(t,r=.2,a=3){const s=t.pos.x;t.tween(0,1,r,n=>{const o=n*10*Math.PI*2*r;t.pos.x=s+Math.sin(o)*a},e.easings.easeOutCubic)}function g(t){t.animate("pos",[e.vec2(0),e.vec2(0,2)],{duration:1,direction:"ping-pong",easing:e.easings.easeInOutSine})}function u(t){t.tween(e.vec2(.6,1.2),e.vec2(1),1,r=>{t.scale=r},e.easings.easeOutElastic)}function w(t,r,a,s=!1){const n=s?-1:1;e.drawSprite({sprite:"diamond",pos:e.vec2(t.xOffset*n,0),anchor:"center",flipX:s}),e.drawText({text:r.toString(),size:14,pos:e.vec2(t.xOffset*n+.3,-.5),anchor:"center",align:"center",font:"Numbers",letterSpacing:-10});for(let o=0;o<a;o++){const c=n*(t.xOffset+11),l=o*t.spacing+6,d=o%2===0?0:t.spacing;e.drawSprite({sprite:"point",frame:o<r?0:1,opacity:o<r?1:.5,pos:e.vec2(c-n*d,n*l),anchor:"center",flipY:!s,flipX:!s})}}function P(){const t=e.add([e.pos(i.xPosition,e.height()-i.yOffset),e.anchor("center"),e.layer("game"),{canShoot:!1,reloadSpeed:10,bulletSpeed:3,ammo:5,maxAmmo:0},"player"]);t.maxAmmo=t.ammo;const r=t.add([e.sprite("hero"),e.pos(),e.animate({relative:!0}),e.layer("game"),e.z(1),e.anchor("center"),e.timer()]);return g(r),t.onDraw(()=>{i.mode==="game"&&w(i,t.ammo,t.maxAmmo,!0)}),t.shoot=()=>{if(t.ammo>0&&t.canShoot){let s=function(){a.unuse("move"),a.sprite="hit",a.play("play"),a.onAnimEnd(n=>{a.destroy()})};t.ammo-=1,t.canShoot=!1,e.wait(.1*t.reloadSpeed,()=>{t.canShoot=!0}),r.unanimate("pos"),u(r);const a=e.add([e.pos(t.pos),e.sprite("bullet",{anim:"play"}),e.area({scale:.4}),e.offscreen({destroy:!0}),e.anchor("center"),e.layer("game"),e.move(e.UP,t.bulletSpeed*30),"bullet"]);a.onCollide("shield",()=>{s()}),a.onCollide("crown",()=>{s()}),g(r)}},t}const z={TEST:{health:()=>1,shields:()=>1,radius:()=>40,speed:()=>.3,score:()=>e.randi(8,11)},easy:{health:()=>e.randi(3,5),shields:()=>e.randi(3,5),radius:()=>40,speed:()=>e.rand(.45,.7),score:()=>3},medium:{health:()=>e.randi(4,6),shields:()=>e.randi(4,6),radius:()=>36,speed:()=>e.rand(1.1,1.2),score:()=>e.randi(5,8)},hard:{health:()=>e.randi(6,9),shields:()=>e.randi(5,7),radius:()=>36,speed:()=>e.rand(1.4,1.5),score:()=>e.randi(9,12)},imposible:{health:()=>e.randi(9,11),shields:()=>e.randi(6,8),radius:()=>32,speed:()=>e.rand(1.7,1.8),score:()=>16}};function A(t="easy"){const r=z[t];return{health:r.health(),shields:r.shields(),radius:r.radius(),speed:r.speed(),score:r.score()}}function C(t,r,a){return e.vec2(t.x+(r.x-t.x)*a,t.y+(r.y-t.y)*a)}function T(t,r,a,s){const n=2*Math.PI/a*r+t;return e.vec2(Math.cos(n)*s,Math.sin(n)*s)}function E(t,r,a,s){const n=(r/a+t*.1)%1,o=Math.floor(n*4),c=n*4%1;switch(o){case 0:return e.vec2(-s+2*s*c,-s);case 1:return e.vec2(s,-s+2*s*c);case 2:return e.vec2(s-2*s*c,s);case 3:return e.vec2(-s,s-2*s*c)}}function I(t,r,a,s){let n=(r/a+t*.1)%1;n>=1&&(n=0);const o=n*3;let c=Math.floor(o);c>=3&&(c=2);const l=o-c,d=Math.sqrt(3)*s,m=[e.vec2(0,-d/2),e.vec2(-s,d/2),e.vec2(s,d/2)],v=m[c],b=m[(c+1)%3];return C(v,b,l)}function L(t){const r="circle",a=e.randi(7),s=a!=4&&e.rand()<.5;for(let n=0;n<t.shields;n++){const o=e.add([e.sprite("shield",{frame:a,flipX:s}),e.anchor("center"),e.area({scale:e.vec2(.65,.5),offset:e.vec2(0,1.4)}),e.pos(t.pos),e.layer("game"),e.timer(),e.z(1),"shield"]);o.onCollide("bullet",()=>{u(o)}),t.createdShields.push({shield:o,index:n})}t.onUpdate(()=>{if(!t.has("health"))return;const n=e.time()*t.speed*t.direction;let o=e.vec2(0,0);t.createdShields.forEach(({shield:c,index:l})=>{switch(r){case"circle":o=T(n,l,t.shields,t.radius);break;case"square":o=E(n,l,t.shields,t.radius);break;case"triangle":o=I(n,l,t.shields,t.radius);break}c.moveTo(t.pos.x+o.x,t.pos.y+o.y)})}),t.onDeath(()=>{t.createdShields.forEach(({shield:n},o)=>{e.wait(.3*o,()=>{n.sprite="explode",n.play("play"),n.onAnimEnd(c=>{n.destroy()})})})})}function x(){const t=A(i.difficulty),r=e.add([e.health(t.health),e.pos(i.xPosition,i.yOffset+5),e.area({shape:new e.Rect(e.vec2(0),16,16)}),e.anchor("center"),e.layer("game"),{shields:t.shields,radius:t.radius,speed:t.speed,score:t.score,direction:e.rand()<.5?1:-1,createdShields:[]},"crown"]),a=r.add([e.sprite("crown"),e.pos(),e.anchor("center"),e.animate({relative:!0}),e.timer()]);return g(a),r.onDraw(()=>{i.mode!=="game"||!r.has("health")||w(i,r.hp,r.maxHP)}),L(r),r.onCollide("bullet",()=>{y(a),u(a),r.hp-=1}),r.onDeath(()=>{r.unuse("health"),e.shake(4);const s=.25*r.createdShields.length+1;y(a,s,2),e.tween(i.score,i.score+=r.score,2,n=>i.score=Math.ceil(n),e.easings.easeOutQuint),e.wait(s,()=>{e.shake(2),r.destroy()})}),r}e.scene("game",()=>{const t="bg"+e.randi(5);e.onResize(()=>{i.yOffset=f(),i.xPosition=e.center().x}),e.add([e.sprite(t.toString()),e.pos(e.center()),e.anchor("center"),e.layer("background")]);const r=P();r.canShoot=!0;const a=e.vec2(e.center().x+i.xOffset,r.pos.y);x(),e.onDestroy("crown",()=>{e.wait(.25,()=>{x(),S()})}),e.onCollide("crown","bullet",(n,o)=>{e.shake(1),r.ammo+=1}),e.onCollide("shield","bullet",(n,o)=>{e.shake(1)}),e.onUpdate(()=>{r.ammo===0&&e.get("bullet").length<=0&&(i.mode="over")});function s(){i.mode==="start"?i.mode="game":r.shoot()}e.onButtonPress("secondary",()=>{r.ammo=r.maxAmmo}),e.onButtonDown("primary",()=>{s()}),e.onDraw(()=>{i.mode=="start"?(e.drawSprite({sprite:"inputs",pos:e.vec2(e.center().x-7.7,e.center().y+20),frame:1,anchor:"center"}),e.drawText({text:"Press     to shoot",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+20),letterSpacing:-5,size:14}),e.drawText({text:"by FABRIC VISIONS",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+92),letterSpacing:-2.8,size:8,opacity:.4})):i.mode=="game"?i.score>=0&&(e.drawText({text:String(i.score).padStart(2,"0"),size:28,pos:e.vec2(a.x,a.y-6),anchor:"center",align:"center",font:"Numbers",letterSpacing:-18}),e.drawText({text:"SCORE",size:8,pos:e.vec2(a.x-.4,a.y+6),anchor:"center",align:"center",letterSpacing:-2,opacity:.5})):i.mode=="over"&&e.go("over")})});e.scene("menu",t=>{e.onDraw(()=>{e.drawSprite({sprite:"TITLE",anchor:"center",pos:e.vec2(e.center().x,e.center().y+16)}),e.drawText({text:"10   %",size:10,width:120,anchor:"center",align:"center",letterSpacing:-2,pos:e.vec2(e.center().x,e.center().y-16)})})});e.loadSprite("border","/sprites/border.png",{slice9:{left:6,right:6,top:6,bottom:6}});e.loadSpriteAtlas("sprites/gui-sheet.png",{diamond:{x:0,y:0,width:16,height:16},point:{x:32,y:0,width:32,height:16,sliceX:2},RIP:{x:0,y:16,width:16,height:16},restart:{x:16,y:16,width:16,height:16},inputs:{x:0,y:32,width:64,height:16,sliceX:4}});e.loadSpriteAtlas("sprites/tileset.png",{hero:{x:16,y:0,width:16,height:16},bullet:{x:32,y:0,width:32,height:16,sliceX:2,anims:{play:{from:0,to:1,loop:!0}}},crown:{x:0,y:0,width:16,height:16},shield:{x:0,y:16,width:64,height:32,sliceX:4,sliceY:2}});e.loadSpriteAtlas("sprites/fx-sheet.png",{explode:{x:0,y:0,width:96,height:16,sliceX:6,anims:{play:{from:0,to:5,speed:12}}},hit:{x:0,y:16,width:64,height:16,sliceX:4,anims:{play:{from:0,to:3,speed:12}}}});e.loadSprite("bg0","map/backgrounds/png/Level_0.png");e.loadSprite("bg1","map/backgrounds/png/Level_1.png");e.loadSprite("bg2","map/backgrounds/png/Level_2.png");e.loadSprite("bg3","map/backgrounds/png/Level_3.png");e.loadSprite("bg4","map/backgrounds/png/Level_4.png");e.setLayers(["background","game","foreground","shader"],"shader");e.onLoad(()=>{e.go("game")});
//# sourceMappingURL=index-BnWMokRv.js.map
