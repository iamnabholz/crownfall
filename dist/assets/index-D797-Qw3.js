import{j as b}from"./kaplay-DbgAWYSR.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}})();function k(){e.loadRoot("./"),e.loadBitmapFont("Alkhemikal","fonts/Alkhemikal.png",24,32,{filter:"nearest",chars:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"}),e.loadBitmapFont("NameHere","fonts/NameHere.png",24,32,{filter:"nearest",chars:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"}),e.loadBitmapFont("Numbers","fonts/Number.png",30,30,{filter:"nearest",chars:" #$%'()*+,-./0123456789:<=>"}),e.loadBitmapFont("Classic","fonts/ClassicShit.png",30,30,{filter:"nearest",chars:" !&'()*+,.0123456789:;=?ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"}),e.loadFont("Menu","fonts/MenuCard.ttf"),e.loadSprite("TITLE","sprites/title.png")}const e=b({global:!1,width:240,height:208,scale:4,font:"NameHere",crisp:!0,texFilter:"nearest",loadingScreen:!0,background:[10,10,20],debug:!0,buttons:{primary:{keyboard:["x","up"],gamepad:["south"],mouse:["left"]},secondary:{keyboard:["z","left"],gamepad:["west"],mouse:["right"]}}}),i={difficulty:"easy",mode:"start",score:0,highscore:0,yOffset:48,xOffset:72,spacing:6,tintColor:[244,78,56]};k();e.loadShader("tint",null,`
  uniform vec3 u_color;

  vec4 frag(vec2 pos, vec2 uv, vec4 color, sampler2D tex) {
      vec4 c = def_frag();
      return vec4(u_color.x * c.r,
        u_color.y * c.g,
        u_color.z * c.b,
        c.a);
  }
`);const p=[[139,200,254],[207,171,74],[244,78,56],[0,255,174],[166,146,176]],h=[];function x(){const t=p.map((s,c)=>c).filter(s=>!h.includes(s)),r=t[Math.floor(Math.random()*t.length)];h.push(r),h.length>2&&h.shift(),i.tintColor=p[r];const[a,o,n]=p[r].map(s=>s/255);e.usePostEffect("tint",()=>({u_color:e.rgb(a,o,n)}))}x();e.onLoading(t=>{e.randSeed(Date.now()),e.drawText({text:(Math.floor(t)+" %").toString(),size:10,width:120,anchor:"center",align:"center",letterSpacing:-2,pos:e.center(),color:e.WHITE})});e.scene("over",()=>{e.add([e.sprite("restart"),e.pos(e.center().x,e.center().y+48),e.anchor("center"),e.area(),"restart"]),i.score>i.highscore&&(i.highscore=i.score),e.onClick("restart",()=>{i.score=0,i.mode="start",e.go("game")}),e.onDraw(()=>{e.drawSprite({sprite:"RIP",width:24,height:24,pos:e.vec2(e.center().x,e.center().y-64),anchor:"center"}),e.drawText({text:"GAME OVER",font:"Alkhemikal",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y-26),letterSpacing:-4,size:28}),e.drawText({text:"Score: "+i.score,anchor:"center",align:"center",pos:e.center(),letterSpacing:-5,size:16}),e.drawText({text:"Highscore: "+i.highscore,anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+16),letterSpacing:-5,size:16}),e.drawText({text:"by FABRIC VISIONS",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.height()-10),letterSpacing:-2.8,size:8,opacity:.4})})});function m(t,r=.2,a=3){const o=t.pos.x;t.tween(0,1,r,n=>{const s=n*20*Math.PI*2*r;t.pos.x=o+Math.sin(s)*a},e.easings.easeOutCubic)}function g(t){t.animate("pos",[e.vec2(0),e.vec2(0,2)],{duration:1,direction:"ping-pong",easing:e.easings.easeInOutSine})}function f(t){t.tween(e.vec2(.6,1.2),e.vec2(1),1,r=>{t.scale=r},e.easings.easeOutElastic)}function S(t,r,a,o=!1){const n=o?-1:1;e.drawSprite({sprite:"diamond",pos:e.vec2(t.xOffset*n,0),anchor:"center",flipX:o}),e.drawText({text:r.toString(),size:14,pos:e.vec2(t.xOffset*n+.3,-.5),anchor:"center",align:"center",font:"Numbers",letterSpacing:-10});for(let s=0;s<a;s++){const c=n*(t.xOffset+11),l=s*t.spacing+6,d=s%2===0?0:t.spacing;e.drawSprite({sprite:"point",frame:s<r?0:1,opacity:s<r?1:.5,pos:e.vec2(c-n*d,n*l),anchor:"center",flipY:!o,flipX:!o})}}function C(){const t=e.add([e.pos(e.center().x,e.height()-i.yOffset),e.anchor("center"),e.layer("game"),{canShoot:!1,reloadSpeed:10,bulletSpeed:3,ammo:5,maxAmmo:0},"player"]);t.maxAmmo=t.ammo;const r=t.add([e.sprite("hero"),e.pos(),e.animate({relative:!0}),e.layer("game"),e.z(1),e.anchor("center"),e.timer()]);return g(r),t.onDraw(()=>{i.mode==="game"&&S(i,t.ammo,t.maxAmmo,!0)}),t.shoot=()=>{if(t.ammo>0&&t.canShoot){let o=function(){a.unuse("move"),a.sprite="hit",a.play("play"),a.onAnimEnd(n=>{a.destroy()})};t.ammo-=1,t.canShoot=!1,e.wait(.1*t.reloadSpeed,()=>{t.canShoot=!0}),r.unanimate("pos"),f(r);const a=e.add([e.pos(t.pos),e.sprite("bullet",{anim:"play"}),e.area({scale:.4}),e.offscreen({destroy:!0}),e.anchor("center"),e.layer("game"),e.move(e.UP,t.bulletSpeed*30),"bullet"]);a.onCollide("shield",()=>{o()}),a.onCollide("crown",()=>{o()}),g(r)}},t}const A={TEST:{health:()=>1,shields:()=>1,radius:()=>40,speed:()=>.3,score:()=>e.randi(8,11)},easy:{health:()=>e.randi(3,5),shields:()=>e.randi(3,5),radius:()=>40,speed:()=>e.rand(.45,.7),score:()=>3},medium:{health:()=>e.randi(4,6),shields:()=>e.randi(4,6),radius:()=>36,speed:()=>e.rand(1.1,1.2),score:()=>e.randi(5,8)},hard:{health:()=>e.randi(6,9),shields:()=>e.randi(5,7),radius:()=>36,speed:()=>e.rand(1.4,1.5),score:()=>e.randi(9,12)},imposible:{health:()=>e.randi(9,11),shields:()=>e.randi(6,8),radius:()=>32,speed:()=>e.rand(1.7,1.8),score:()=>16}};function O(t="easy"){const r=A[t];return{health:r.health(),shields:r.shields(),radius:r.radius(),speed:r.speed(),score:r.score()}}function z(t,r,a){return e.vec2(t.x+(r.x-t.x)*a,t.y+(r.y-t.y)*a)}function T(t,r,a,o){const n=2*Math.PI/a*r+t;return e.vec2(Math.cos(n)*o,Math.sin(n)*o)}function E(t,r,a,o){const n=(r/a+t*.1)%1,s=Math.floor(n*4),c=n*4%1;switch(s){case 0:return e.vec2(-o+2*o*c,-o);case 1:return e.vec2(o,-o+2*o*c);case 2:return e.vec2(o-2*o*c,o);case 3:return e.vec2(-o,o-2*o*c)}}function I(t,r,a,o){let n=(r/a+t*.1)%1;n>=1&&(n=0);const s=n*3;let c=Math.floor(s);c>=3&&(c=2);const l=s-c,d=Math.sqrt(3)*o,u=[e.vec2(0,-d/2),e.vec2(-o,d/2),e.vec2(o,d/2)],w=u[c],v=u[(c+1)%3];return z(w,v,l)}function L(t){const r="circle",a=e.randi(7),o=a!=4&&e.rand()<.5;for(let n=0;n<t.shields;n++){const s=e.add([e.sprite("shield",{frame:a,flipX:o}),e.anchor("center"),e.area({scale:e.vec2(.65,.5),offset:e.vec2(0,1.4)}),e.pos(t.pos),e.layer("game"),e.timer(),e.z(1),"shield"]);s.onCollide("bullet",()=>{f(s)}),t.createdShields.push({shield:s,index:n})}t.onUpdate(()=>{if(!t.has("health"))return;const n=e.time()*t.speed*t.direction;let s=e.vec2(0,0);t.createdShields.forEach(({shield:c,index:l})=>{switch(r){case"circle":s=T(n,l,t.shields,t.radius);break;case"square":s=E(n,l,t.shields,t.radius);break;case"triangle":s=I(n,l,t.shields,t.radius);break}c.moveTo(t.pos.x+s.x,t.pos.y+s.y)})}),t.onDeath(()=>{t.createdShields.forEach(({shield:n},s)=>{e.wait(.3*s,()=>{n.sprite="explode",n.play("play"),n.onAnimEnd(c=>{n.destroy()})})})})}function y(){const t=O(i.difficulty),r=e.add([e.health(t.health),e.pos(e.center().x,i.yOffset+5),e.area({shape:new e.Rect(e.vec2(0),16,16)}),e.anchor("center"),e.layer("game"),{shields:t.shields,radius:t.radius,speed:t.speed,score:t.score,direction:e.rand()<.5?1:-1,createdShields:[]},"crown"]),a=r.add([e.sprite("crown"),e.pos(),e.anchor("center"),e.animate({relative:!0}),e.timer()]);return g(a),r.onDraw(()=>{i.mode!=="game"||!r.has("health")||S(i,r.hp,r.maxHP)}),L(r),r.onCollide("bullet",()=>{m(a),f(a),r.hp-=1}),r.onDeath(()=>{r.unuse("health"),e.shake(4);const o=.25*r.createdShields.length+1;m(a,o,2),e.tween(i.score,i.score+=r.score,2,n=>i.score=Math.ceil(n),e.easings.easeOutQuint),e.wait(o,()=>{e.shake(2),r.destroy()})}),r}e.scene("game",()=>{const t="bg"+e.randi(5);e.add([e.sprite(t.toString()),e.pos(e.center()),e.anchor("center"),e.layer("background")]);const r=C();r.canShoot=!0,y(),e.onDestroy("crown",()=>{e.wait(.25,()=>{y(),x()})}),e.onCollide("crown","bullet",(o,n)=>{e.shake(1),r.ammo+=1}),e.onCollide("shield","bullet",(o,n)=>{e.shake(1)}),e.onUpdate(()=>{r.ammo===0&&e.get("bullet").length<=0&&(i.mode="over")});function a(){i.mode==="start"?i.mode="game":r.shoot()}e.onButtonPress("secondary",()=>{r.ammo=r.maxAmmo}),e.onButtonDown("primary",()=>{a()}),e.onDraw(()=>{if(i.mode=="start")e.drawSprite({sprite:"inputs",pos:e.vec2(e.center().x-7.7,e.center().y+20),frame:1,anchor:"center"}),e.drawText({text:"Press     to shoot",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+20),letterSpacing:-5,size:14}),e.drawText({text:"by FABRIC VISIONS",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.height()-10),letterSpacing:-2.8,size:8,opacity:.4});else if(i.mode=="game"){if(i.score>=0){const o=e.vec2(e.center().x+i.xOffset,r.pos.y);e.drawSprite({sprite:"border",pos:e.vec2(o.x-1,o.y-1),width:56,height:48,anchor:"center"}),e.drawText({text:String(i.score).padStart(2,"0"),size:28,pos:e.vec2(o.x,o.y-6),anchor:"center",align:"center",font:"Numbers",letterSpacing:-18}),e.drawText({text:"SCORE",size:8,pos:e.vec2(o.x-.4,o.y+6),anchor:"center",align:"center",letterSpacing:-2,opacity:.5})}}else i.mode=="over"&&e.go("over")})});e.scene("menu",t=>{e.onDraw(()=>{e.drawSprite({sprite:"TITLE",anchor:"center",pos:e.vec2(e.center().x,e.center().y+16)}),e.drawText({text:"10   %",size:10,width:120,anchor:"center",align:"center",letterSpacing:-2,pos:e.vec2(e.center().x,e.center().y-16)})})});e.loadSprite("border","/sprites/border.png",{slice9:{left:16,right:16,top:16,bottom:16}});e.loadSpriteAtlas("sprites/gui-sheet.png",{diamond:{x:0,y:0,width:16,height:16},point:{x:32,y:0,width:32,height:16,sliceX:2},RIP:{x:0,y:16,width:16,height:16},restart:{x:16,y:16,width:16,height:16},inputs:{x:0,y:32,width:64,height:16,sliceX:4}});e.loadSpriteAtlas("sprites/tileset.png",{hero:{x:16,y:0,width:16,height:16},bullet:{x:32,y:0,width:32,height:16,sliceX:2,anims:{play:{from:0,to:1,loop:!0}}},crown:{x:0,y:0,width:16,height:16},shield:{x:0,y:16,width:64,height:32,sliceX:4,sliceY:2}});e.loadSpriteAtlas("sprites/fx-sheet.png",{explode:{x:0,y:0,width:96,height:16,sliceX:6,anims:{play:{from:0,to:5,speed:12}}},hit:{x:0,y:16,width:64,height:16,sliceX:4,anims:{play:{from:0,to:3,speed:12}}}});e.loadSprite("bg0","map/backgrounds/png/Level_0.png");e.loadSprite("bg1","map/backgrounds/png/Level_1.png");e.loadSprite("bg2","map/backgrounds/png/Level_2.png");e.loadSprite("bg3","map/backgrounds/png/Level_3.png");e.loadSprite("bg4","map/backgrounds/png/Level_4.png");e.setLayers(["background","game","foreground","shader"],"shader");e.onLoad(()=>{e.go("game")});
//# sourceMappingURL=index-D797-Qw3.js.map
