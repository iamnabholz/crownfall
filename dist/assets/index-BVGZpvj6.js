import{j as T}from"./kaplay-DbgAWYSR.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();const w=[[139,200,254],[207,171,74],[244,78,56],[0,255,174],[166,146,176]],m=[];function v(){const t=w.map((i,l)=>l).filter(i=>!m.includes(i)),o=t[Math.floor(Math.random()*t.length)];m.push(o),m.length>2&&m.shift();const[n,s,a]=w[o].map(i=>i/255);e.usePostEffect("tint",()=>({u_color:e.rgb(n,s,a)}))}function C(){e.loadRoot("./"),e.loadShader("tint",null,`
    uniform vec3 u_color;

    vec4 frag(vec2 pos, vec2 uv, vec4 color, sampler2D tex) {
        vec4 c = def_frag();
        return vec4(u_color.x * c.r,
          u_color.y * c.g,
          u_color.z * c.b,
          c.a);
    }
  `),v(),e.loadBitmapFont("Alkhemikal","fonts/Alkhemikal.png",24,32,{filter:"nearest",chars:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"}),e.loadBitmapFont("NameHere","fonts/NameHere.png",24,32,{filter:"nearest",chars:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"}),e.loadBitmapFont("Numbers","fonts/Number.png",30,30,{filter:"nearest",chars:" #$%'()*+,-./0123456789:<=>"}),e.loadBitmapFont("Classic","fonts/ClassicShit.png",30,30,{filter:"nearest",chars:" !&'()*+,.0123456789:;=?ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"}),e.loadFont("Menu","fonts/MenuCard.ttf"),e.loadSprite("TITLE","sprites/title.png"),e.loadSpriteAtlas("sprites/projectile-sheet.png",{bullet:{x:0,y:0,width:48,height:16,sliceX:3,anims:{play:{from:0,to:2,loop:!0,speed:24}}}}),e.loadSpriteAtlas("sprites/gui-sheet.png",{diamond:{x:0,y:0,width:16,height:16},point:{x:16,y:0,width:48,height:16,sliceX:3},RIP:{x:0,y:16,width:16,height:16},border:{x:48,y:0,width:32,height:32,slice9:{left:6,right:6,top:6,bottom:6}},restart:{x:16,y:16,width:16,height:16},inputs:{x:0,y:32,width:80,height:16,sliceX:5}}),e.loadSpriteAtlas("sprites/tileset.png",{hero:{x:16,y:0,width:16,height:16},crown:{x:0,y:0,width:16,height:16},shield:{x:0,y:16,width:64,height:32,sliceX:4,sliceY:2}}),e.loadSpriteAtlas("sprites/fx-sheet.png",{explode:{x:0,y:0,width:96,height:16,sliceX:6,anims:{play:{from:0,to:5,speed:12}}},hit:{x:0,y:16,width:64,height:16,sliceX:4,anims:{play:{from:0,to:3,speed:12}}},particle:{x:64,y:16,width:32,height:16,sliceX:2}}),e.loadSprite("bg0","map/backgrounds/png/Level_0.png"),e.loadSound("music","sounds/ReClaimed.mp3")}const e=T({global:!1,scale:4,font:"NameHere",crisp:!0,texFilter:"nearest",loadingScreen:!0,background:[10,10,20],debug:!0,buttons:{primary:{keyboard:["x","up"],gamepad:["south"],mouse:["left"]},secondary:{keyboard:["z","left"],gamepad:["west"],mouse:["right"]}}});C();e.onLoading(t=>{e.drawText({text:(Math.floor(t)+" %").toString(),size:10,width:120,anchor:"center",align:"center",letterSpacing:-2,pos:e.center(),color:e.WHITE})});function R(t=48){let o=t;const n=128,s=e.height()-o*2;if(s>n){const a=s-n;o=o+a/2}return o}function E(t){const o=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]];let n="";for(const[s,a]of o)for(;t>=s;)n+=a,t-=s;return n}e.scene("over",()=>{const t=e.add([e.sprite("restart"),e.pos(e.center().x,e.center().y+48),e.anchor("center"),e.area(),e.layer("foreground"),"restart"]);r.score>r.highscore&&(r.highscore=r.score),t.onClick(()=>{r.score=0,r.mode="start",e.go("game")}),e.onDraw(()=>{e.drawRect({width:200,height:150,pos:e.center(),anchor:"center",fill:!1,outline:{color:e.WHITE,width:1.5,join:"miter"}}),e.drawSprite({sprite:"RIP",width:24,height:24,pos:e.vec2(e.center().x,e.center().y-82),anchor:"center"}),e.drawText({text:"GAME OVER",font:"Alkhemikal",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y-44),letterSpacing:-4,size:28}),e.drawText({text:"Score: "+r.score,anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y-16),letterSpacing:-5,size:16}),e.drawText({text:"Highscore: "+r.highscore,anchor:"center",align:"center",pos:e.center(),letterSpacing:-5,size:16}),e.drawText({text:"Kills: "+r.enemiesBeaten,anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+18),letterSpacing:-7,size:16}),e.drawRect({width:24,height:24,pos:e.vec2(e.center().x,e.center().y+48),anchor:"center",fill:!1,outline:{color:e.WHITE,width:1,join:"miter"}}),e.drawText({text:"by FABRIC VISIONS",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+92),letterSpacing:-2.8,size:8,opacity:.4})})});function S(t,o=.2,n=3){const s=t.pos.x;t.tween(0,1,o,a=>{const i=a*10*Math.PI*2*o;t.pos.x=s+Math.sin(i)*n},e.easings.easeOutCubic)}function g(t,o=!1){t.animate("pos",[e.vec2(0),e.vec2(0,o?2:-2)],{duration:1,direction:"ping-pong",easing:e.easings.easeInOutSine})}function x(t){t.tween(e.vec2(.6,1.2),e.vec2(1),1,o=>{t.scale=o},e.easings.easeOutElastic)}function b(t,o,n,s=!1){const a=s?-1:1;e.drawSprite({sprite:"diamond",pos:e.vec2(t.xOffset*a,0),anchor:"center",flipX:s}),e.drawText({text:o.toString(),size:14,pos:e.vec2(t.xOffset*a+.3,-.5),anchor:"center",align:"center",font:"Numbers",letterSpacing:-10});for(let i=0;i<n;i++){const l=a*(t.xOffset+13),p=i*t.spacing+8,h=i%2===0?0:t.spacing;e.drawSprite({sprite:"point",frame:i<o?s?1:0:2,opacity:i<o?1:.5,pos:e.vec2(l-a*h,a*p),anchor:"center"})}}function I(){const t=e.add([e.pos(r.xPosition,e.height()-r.yOffset),e.anchor("center"),{isAlive:!0,canShoot:!1,reloadSpeed:10,bulletSpeed:3,ammo:5,maxAmmo:0},"player"]);t.maxAmmo=t.ammo;const o=t.add([e.sprite("hero"),e.pos(),e.animate({relative:!0}),e.anchor("center"),e.timer(),e.layer("game"),e.z(2)]);return g(o),t.onDraw(()=>{r.mode==="game"&&b(r,t.ammo,t.maxAmmo,!0)}),t.shoot=()=>{if(t.ammo>0&&t.canShoot){let s=function(){n.unuse("move"),n.o,n.sprite="hit",n.play("play"),n.onAnimEnd(a=>{n.destroy()})};t.ammo-=1,t.canShoot=!1,e.wait(.1*t.reloadSpeed,()=>{t.canShoot=!0}),o.unanimate("pos"),x(o);const n=e.add([e.pos(t.pos),e.sprite("bullet",{anim:"play"}),e.area({scale:.4}),e.offscreen({destroy:!0}),e.anchor("center"),e.move(e.UP,t.bulletSpeed*30),e.layer("game"),"bullet"]);n.onCollide("shield",()=>{s()}),n.onCollide("crown",()=>{s()}),g(o)}},t}const A={TEST:{health:()=>1,shields:()=>1,radius:()=>40,speed:()=>.3,score:()=>e.randi(8,11)},easy:{health:()=>e.randi(3,5),shields:()=>e.randi(3,5),radius:()=>40,speed:()=>e.rand(.45,.7),score:()=>3},medium:{health:()=>e.randi(4,6),shields:()=>e.randi(4,6),radius:()=>36,speed:()=>e.rand(1.1,1.2),score:()=>e.randi(5,8)},hard:{health:()=>e.randi(6,9),shields:()=>e.randi(5,7),radius:()=>36,speed:()=>e.rand(1.4,1.5),score:()=>e.randi(9,12)},imposible:{health:()=>e.randi(9,11),shields:()=>e.randi(6,8),radius:()=>32,speed:()=>e.rand(1.7,1.8),score:()=>16}};function z(t="easy"){const o=A[t];return{health:o.health(),shields:o.shields(),radius:o.radius(),speed:o.speed(),score:o.score()}}function k(t){const o=e.randi(7),n=o!=4&&e.rand()<.5;for(let s=0;s<t.shields;s++){const a=e.add([e.sprite("shield",{frame:o,flipX:n}),e.anchor("center"),e.area({scale:e.vec2(.7,.7),offset:e.vec2(0,1.2)}),e.pos(t.pos),e.timer(),e.layer("game"),e.z(1),"shield"]);a.onCollide("bullet",()=>{x(a)}),t.createdShields.push({shield:a,index:s})}t.onUpdate(()=>{if(!t.has("health"))return;const s=e.time()*t.speed*t.direction;t.createdShields.forEach(({shield:a,index:i},l)=>{const p=2*Math.PI/t.shields*l+s;let h=e.vec2(Math.cos(p)*t.radius,Math.sin(p)*t.radius);a.moveTo(t.pos.x+h.x,t.pos.y+h.y)})}),t.onDeath(()=>{t.createdShields.forEach(({shield:s},a)=>{e.wait(.3*a,()=>{s.sprite="explode",s.play("play"),s.onAnimEnd(i=>{s.destroy()})})})})}function F({onDeath:t}={}){const o=z(r.difficulty),n=e.add([e.health(o.health),e.pos(r.xPosition,r.yOffset+5),e.area({shape:new e.Rect(e.vec2(0),16,16)}),e.anchor("center"),{shields:o.shields,radius:o.radius,speed:o.speed,score:o.score,direction:e.rand()<.5?1:-1,createdShields:[]},e.layer("game"),"crown"]),s=n.add([e.sprite("crown"),e.pos(),e.anchor("center"),e.animate({relative:!0}),e.timer(),e.layer("game"),e.z(2)]);return g(s,!0),n.onDraw(()=>{r.mode!=="game"||!n.has("health")||b(r,n.hp,n.maxHP)}),k(n),n.onCollide("bullet",()=>{S(s),x(s),n.hp-=1}),n.onDeath(()=>{n.unuse("health"),e.shake(4);const a=.25*n.createdShields.length+1;S(s,a,2),r.particles.pos=n.pos,e.loop(.25,()=>{r.particles.emit(4)},n.createdShields.length+1),e.wait(a,()=>{t&&t(n),n.destroy()})}),n}const d={currentRoom:0,totalRooms:e.randi(2,5)};e.scene("game",()=>{function t(){return e.vec2(e.randi(4,32-n-4),e.randi(4,32-n-4))}let o="bg0";const n=Math.floor(e.width()/16/2);let s=t();e.add([e.layer("background")]).onDraw(()=>{e.drawSprite({sprite:o.toString(),pos:e.vec2(s.x*-16,s.y*-16)})});const i=I();i.canShoot=!0;function l(){F({onDeath:c=>{d.currentRoom+=1,r.enemiesBeaten+=1,d.currentRoom>=d.totalRooms&&(d.currentRoom=0,r.floor+=1,d.totalRooms=e.randi(2,5)),e.tween(r.score,r.score+=c.score,1,f=>r.score=Math.ceil(f),e.easings.easeOutQuint),e.wait(.25,()=>{e.shader(5),s=t(),v(),l()})}})}l(),e.onCollide("crown","bullet",(c,f)=>{e.shake(1),i.ammo+=1}),e.onCollide("shield","bullet",(c,f)=>{e.shake(1)}),e.onUpdate(()=>{i.ammo===0&&e.get("bullet").length<=0&&i.isAlive&&(i.isAlive=!1,e.shake(6),r.particles.pos=i.pos,e.loop(.2,()=>{r.particles.emit(4)},6).onEnd(()=>{r.mode="over"}))});function p(){r.mode==="start"?(r.mode="game",e.play("music",{loop:!0})):i.shoot()}e.onButtonPress("secondary",()=>{}),e.onButtonDown("primary",()=>{p()});let h=1,u=0;function y(){e.tween(1,0,1,c=>h=c,e.easings.easeInOutCubic).onEnd(()=>{u==e.getSprite("inputs").data.frames.length-1?u=0:u+=1,e.tween(0,1,1,c=>h=c,e.easings.easeInOutCubic).onEnd(()=>{e.wait(3,()=>{y()})})})}e.wait(4,()=>{y()}),r.particles=e.add([e.pos(e.center()),e.layer("background"),e.z(2),e.particles({max:100,speed:[60,80],damping:[2,3],lifeTime:[.85,1.2],angle:[0,360],texture:e.getSprite("hit").data.tex,quads:[e.getSprite("hit").data.frames[0],e.getSprite("explode").data.frames[1],e.getSprite("explode").data.frames[0]]},{direction:0,spread:360})]),e.onDraw(()=>{if(r.mode=="start")e.drawSprite({sprite:"TITLE",pos:e.vec2(e.center().x+1,e.center().y+10),anchor:"center"}),e.drawSprite({sprite:"inputs",pos:e.vec2(e.center().x-7.7,e.center().y+34),opacity:h,frame:u,anchor:"center"}),e.drawText({text:"Press     to shoot",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+34),letterSpacing:-5,size:14}),e.drawText({text:"by FABRIC VISIONS",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+92),letterSpacing:-2.8,size:8,opacity:.4});else if(r.mode=="game"){e.drawText({text:"FLOOR",size:6,pos:e.vec2(e.center().x+r.xOffset,e.height()-r.yOffset-8),anchor:"center",align:"center",font:"Alkhemikal",letterSpacing:-1}),e.drawText({text:E(r.floor),size:10,pos:e.vec2(e.center().x+r.xOffset,e.height()-r.yOffset),anchor:"center",align:"center",letterSpacing:-3});for(let c=0;c<d.totalRooms;c++){const f=e.center().x+r.xOffset-7+c*14/(d.totalRooms-1),O=e.height()-r.yOffset+10;e.drawRect({width:3,height:3,pos:e.vec2(f,O),anchor:"center",opacity:c>d.currentRoom?.2:1,fill:!(c>d.currentRoom),outline:{width:.5,join:"miter"}})}r.score>0&&(e.drawText({text:String(r.score).padStart(2,"0"),size:28,pos:e.vec2(e.center().x+r.xOffset,e.height()-r.yOffset-28),anchor:"center",align:"center",font:"Numbers",letterSpacing:-18}),e.drawText({text:"SCORE",size:8,pos:e.vec2(e.center().x+r.xOffset,e.height()-r.yOffset-16),anchor:"center",align:"center",letterSpacing:-2,opacity:.5}))}else r.mode=="over"&&e.go("over")})});e.scene("menu",t=>{e.onDraw(()=>{e.drawSprite({sprite:"TITLE",anchor:"center",pos:e.vec2(e.center().x,e.center().y+16)}),e.drawText({text:"10   %",size:10,width:120,anchor:"center",align:"center",letterSpacing:-2,pos:e.vec2(e.center().x,e.center().y-16)})})});const r={yOffset:R(),xOffset:64,xPosition:e.center().x,spacing:8,particles:null,difficulty:"hard",mode:"start",score:0,highscore:0,enemiesBeaten:0,floor:1};e.setLayers(["background","game","foreground"],"foreground");e.onLoad(()=>{e.randSeed(Date.now()),e.go("game")});
//# sourceMappingURL=index-BVGZpvj6.js.map
