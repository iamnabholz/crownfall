import{o as E}from"./kaplay-55tYStNh.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();const w=[[139,200,254],[207,171,74],[244,78,56],[0,255,174],[166,146,176]],f=[];function v(){const t=w.map((i,c)=>c).filter(i=>!f.includes(i)),n=t[Math.floor(Math.random()*t.length)];f.push(n),f.length>2&&f.shift();const[s,a,r]=w[n].map(i=>i/255);e.usePostEffect("tint",()=>({u_color:e.rgb(s,a,r)}))}function O(){e.loadRoot("./"),e.loadShader("tint",null,`
    uniform vec3 u_color;

    vec4 frag(vec2 pos, vec2 uv, vec4 color, sampler2D tex) {
        vec4 c = def_frag();
        return vec4(u_color.x * c.r,
          u_color.y * c.g,
          u_color.z * c.b,
          c.a);
    }
  `),v(),e.loadBitmapFont("Alkhemikal","fonts/Alkhemikal.png",24,32,{filter:"nearest",chars:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"}),e.loadBitmapFont("NameHere","fonts/NameHere.png",24,32,{filter:"nearest",chars:" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~"}),e.loadBitmapFont("Numbers","fonts/Number.png",30,30,{filter:"nearest",chars:" #$%'()*+,-./0123456789:<=>"}),e.loadBitmapFont("Classic","fonts/ClassicShit.png",30,30,{filter:"nearest",chars:" !&'()*+,.0123456789:;=?ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"}),e.loadFont("Menu","fonts/MenuCard.ttf"),e.loadSprite("TITLE","sprites/title.png"),e.loadSpriteAtlas("sprites/projectile-sheet.png",{bullet:{x:0,y:0,width:48,height:16,sliceX:3,anims:{play:{from:0,to:2,loop:!0,speed:24}}}}),e.loadSpriteAtlas("sprites/gui-sheet.png",{diamond:{x:0,y:0,width:16,height:16},point:{x:16,y:0,width:48,height:16,sliceX:3},RIP:{x:0,y:16,width:16,height:16},border:{x:48,y:0,width:32,height:32,slice9:{left:6,right:6,top:6,bottom:6}},restart:{x:16,y:16,width:16,height:16},inputs:{x:0,y:32,width:80,height:16,sliceX:5}}),e.loadSpriteAtlas("sprites/tileset.png",{hero:{x:16,y:0,width:16,height:16},crown:{x:0,y:0,width:16,height:16},shield:{x:0,y:16,width:64,height:32,sliceX:4,sliceY:2}}),e.loadSpriteAtlas("sprites/fx-sheet.png",{explode:{x:0,y:0,width:96,height:16,sliceX:6,anims:{play:{from:0,to:5,speed:12}}},hit:{x:0,y:16,width:64,height:16,sliceX:4,anims:{play:{from:0,to:3,speed:12}}},particle:{x:64,y:16,width:32,height:16,sliceX:2}}),e.loadSprite("bg0","map/backgrounds/png/Level_0.png"),e.loadSound("music","sounds/ReClaimed.mp3")}const e=E({global:!1,scale:window.screen.orientation.type.includes("landscape")?4:8,font:"NameHere",crisp:!0,texFilter:"nearest",loadingScreen:!0,background:[10,10,20],debug:!0,buttons:{primary:{keyboard:["x","up"],gamepad:["south"],mouse:["left"]},secondary:{keyboard:["z","left"],gamepad:["west"],mouse:["right"]}}});O();e.onLoading(t=>{e.drawText({text:(Math.floor(t)+" %").toString(),size:10,width:120,anchor:"center",align:"center",letterSpacing:-2,pos:e.center(),color:e.WHITE})});function T(t=48){let n=t;const s=124,a=e.height()-n*2;if(a>s){const r=a-s;n=n+r/2}return n}e.scene("over",()=>{const t=e.add([e.sprite("restart"),e.pos(e.center().x,e.center().y+48),e.anchor("center"),e.area(),e.layer("foreground"),"restart"]);o.score>o.highscore&&(o.highscore=o.score),t.onClick(()=>{o.score=0,o.mode="start",e.go("game")}),e.onDraw(()=>{e.drawRect({width:200,height:150,pos:e.center(),anchor:"center",fill:!1,outline:{color:e.WHITE,width:1.5,join:"miter"}}),e.drawSprite({sprite:"RIP",width:24,height:24,pos:e.vec2(e.center().x,e.center().y-82),anchor:"center"}),e.drawText({text:"GAME OVER",font:"Alkhemikal",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y-44),letterSpacing:-4,size:28}),e.drawText({text:"Score: "+o.score,anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y-16),letterSpacing:-5,size:16}),e.drawText({text:"Highscore: "+o.highscore,anchor:"center",align:"center",pos:e.center(),letterSpacing:-5,size:16}),e.drawText({text:"Kills: "+o.enemiesBeaten,anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+18),letterSpacing:-7,size:16}),e.drawRect({width:24,height:24,pos:e.vec2(e.center().x,e.center().y+48),anchor:"center",fill:!1,outline:{color:e.WHITE,width:1,join:"miter"}}),e.drawText({text:"by FABRIC VISIONS",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+92),letterSpacing:-2.8,size:8,opacity:.4})})});function S(t,n=.2,s=3){const a=t.pos.x;t.tween(0,1,n,r=>{const i=r*10*Math.PI*2*n;t.pos.x=a+Math.sin(i)*s},e.easings.easeOutCubic)}function m(t,n=!1){t.animate("pos",[e.vec2(0),e.vec2(0,n?2:-2)],{duration:1,direction:"ping-pong",easing:e.easings.easeInOutSine})}function y(t){t.tween(e.vec2(.6,1.2),e.vec2(1),1,n=>{t.scale=n},e.easings.easeOutElastic)}function b(t,n,s,a=!1){const r=a?-1:1;e.drawSprite({sprite:"diamond",pos:e.vec2(t.xOffset*r,0),anchor:"center",flipX:a}),e.drawText({text:n.toString(),size:14,pos:e.vec2(t.xOffset*r+.3,-.5),anchor:"center",align:"center",font:"Numbers",letterSpacing:-10});for(let i=0;i<s;i++){const c=r*(t.xOffset+13),d=i*t.spacing+8,h=i%2===0?0:t.spacing;e.drawSprite({sprite:"point",frame:i<n?a?1:0:2,opacity:i<n?1:.5,pos:e.vec2(c-r*h,r*d),anchor:"center"})}}function C(){const t=e.add([e.pos(o.xPosition,e.height()-o.yOffset),e.anchor("center"),{isAlive:!0,canShoot:!1,reloadSpeed:10,bulletSpeed:3,ammo:5,maxAmmo:0},"player"]);t.maxAmmo=t.ammo;const n=t.add([e.sprite("hero"),e.pos(),e.animate({relative:!0}),e.anchor("center"),e.timer(),e.layer("game"),e.z(2)]);return m(n),t.onDraw(()=>{o.mode==="game"&&b(o,t.ammo,t.maxAmmo,!0)}),t.shoot=()=>{if(t.ammo>0&&t.canShoot){let a=function(){s.unuse("move"),s.o,s.sprite="hit",s.play("play"),s.onAnimEnd(r=>{s.destroy()})};t.ammo-=1,t.canShoot=!1,e.wait(.1*t.reloadSpeed,()=>{t.canShoot=!0}),n.unanimate("pos"),y(n);const s=e.add([e.pos(t.pos),e.sprite("bullet",{anim:"play"}),e.area({scale:.4}),e.offscreen({destroy:!0}),e.anchor("center"),e.move(e.UP,t.bulletSpeed*30),e.layer("game"),"bullet"]);s.onCollide("shield",()=>{a()}),s.onCollide("crown",()=>{a()}),m(n)}},t}const A={TEST:{health:()=>1,shields:()=>1,radius:()=>40,speed:()=>.3,score:()=>e.randi(8,11)},easy:{health:()=>e.randi(3,5),shields:()=>e.randi(3,5),radius:()=>40,speed:()=>e.rand(.45,.7),score:()=>3},medium:{health:()=>e.randi(4,6),shields:()=>e.randi(4,6),radius:()=>36,speed:()=>e.rand(1.1,1.2),score:()=>e.randi(5,8)},hard:{health:()=>e.randi(6,9),shields:()=>e.randi(5,7),radius:()=>36,speed:()=>e.rand(1.4,1.5),score:()=>e.randi(9,12)},imposible:{health:()=>e.randi(9,11),shields:()=>e.randi(6,8),radius:()=>32,speed:()=>e.rand(1.7,1.8),score:()=>16}};function I(t="easy"){const n=A[t];return{health:n.health(),shields:n.shields(),radius:n.radius(),speed:n.speed(),score:n.score()}}function z(t){const n=e.randi(7),s=n!=4&&e.rand()<.5;for(let a=0;a<t.shields;a++){const r=e.add([e.sprite("shield",{frame:n,flipX:s}),e.anchor("center"),e.area({scale:e.vec2(.7,.7),offset:e.vec2(0,1.2)}),e.pos(t.pos),e.timer(),e.layer("game"),e.z(1),"shield"]);r.onCollide("bullet",()=>{y(r)}),t.createdShields.push({shield:r,index:a})}t.onUpdate(()=>{if(!t.has("health"))return;const a=e.time()*t.speed*t.direction;t.createdShields.forEach(({shield:r,index:i},c)=>{const d=2*Math.PI/t.shields*c+a;let h=e.vec2(Math.cos(d)*t.radius,Math.sin(d)*t.radius);r.moveTo(t.pos.x+h.x,t.pos.y+h.y)})}),t.onDeath(()=>{t.createdShields.forEach(({shield:a},r)=>{e.wait(.3*r,()=>{a.sprite="explode",a.play("play"),a.onAnimEnd(i=>{a.destroy()})})})})}function P({onDeath:t}={}){const n=["easy","medium","hard","easy","medium","hard","easy","medium","easy","medium","imposible"];let s=e.choose(n),a=I(s);console.log(s);const r=e.add([e.health(a.health),e.pos(o.xPosition,o.yOffset+5),e.area({shape:new e.Rect(e.vec2(0),16,16)}),e.anchor("center"),{shields:a.shields,radius:a.radius,speed:a.speed,score:a.score,direction:e.rand()<.5?1:-1,createdShields:[]},e.layer("game"),"crown"]),i=r.add([e.sprite("crown"),e.pos(),e.anchor("center"),e.animate({relative:!0}),e.timer(),e.layer("game"),e.z(2)]);return m(i,!0),r.onDraw(()=>{o.mode!=="game"||!r.has("health")||b(o,r.hp,r.maxHP)}),z(r),r.onCollide("bullet",()=>{S(i),y(i),r.hp-=1}),r.onDeath(()=>{r.unuse("health"),e.shake(4);const c=.25*r.createdShields.length+1;S(i,c,2),o.particles.pos=r.pos,e.loop(.25,()=>{o.particles.emit(4)},r.createdShields.length+1),e.wait(c,()=>{t&&t(r),r.destroy()})}),r}e.scene("game",()=>{function t(){return e.vec2(e.randi(4,32-s-4),e.randi(4,32-s-4))}let n="bg0";const s=Math.floor(e.width()/16/2);let a=t();const r=192/32;e.add([e.layer("background")]).onDraw(()=>{e.drawSprite({sprite:n.toString(),pos:e.vec2(a.x*-16,a.y*-16)})});const c=C();c.canShoot=!0;function d(){P({onDeath:l=>{c.canShoot=!1,o.enemiesBeaten+=1,e.tween(o.score,o.score+=l.score,1,p=>o.score=Math.ceil(p),e.easings.easeOutQuint),e.wait(.25,()=>{e.shader(5),a=t(),v(),d(),c.canShoot=!0})}})}d(),e.onCollide("crown","bullet",(l,p)=>{e.shake(1),c.ammo+=1}),e.onCollide("shield","bullet",(l,p)=>{e.shake(1)}),e.onUpdate(()=>{c.ammo===0&&e.get("bullet").length<=0&&c.isAlive&&(c.isAlive=!1,e.shake(6),o.particles.pos=c.pos,e.loop(.2,()=>{o.particles.emit(4)},6).onEnd(()=>{o.mode="over"}))});function h(){o.mode==="start"?(o.mode="game",e.play("music",{loop:!0})):c.shoot()}e.onButtonPress("secondary",()=>{}),e.onButtonDown("primary",()=>{h()});let g=1,u=0;function x(){e.tween(1,0,1,l=>g=l,e.easings.easeInOutCubic).onEnd(()=>{u==e.getSprite("inputs").data.frames.length-1?u=0:u+=1,e.tween(0,1,1,l=>g=l,e.easings.easeInOutCubic).onEnd(()=>{e.wait(3,()=>{x()})})})}e.wait(4,()=>{x()}),o.particles=e.add([e.pos(e.center()),e.layer("background"),e.z(2),e.particles({max:100,speed:[60,80],damping:[2,3],lifeTime:[.85,1.2],angle:[0,360],texture:e.getSprite("hit").data.tex,quads:[e.getSprite("hit").data.frames[0],e.getSprite("explode").data.frames[1],e.getSprite("explode").data.frames[0]]},{direction:0,spread:360})]),e.onDraw(()=>{if(o.mode=="start"){const l=window.innerWidth>768&&window.screen.orientation.type.includes("landscape")?192:window.innerWidth/8,p=l/r;e.drawSprite({width:l,height:p,scale:e.vec2(1),sprite:"TITLE",pos:e.vec2(e.center().x+1,e.center().y+10),anchor:"center"}),e.drawSprite({sprite:"inputs",pos:e.vec2(e.center().x-7,e.center().y+34),opacity:g,frame:u,anchor:"center"}),e.drawText({text:"Press     to shoot",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+34),letterSpacing:-4,size:12}),e.drawText({text:"by FABRIC VISIONS",anchor:"center",align:"center",pos:e.vec2(e.center().x,e.center().y+92),letterSpacing:-2.8,size:8,opacity:.4})}else o.mode=="game"?o.score>0&&(e.drawText({text:String(o.score).padStart(2,"0"),size:28,pos:e.vec2(e.center().x+o.xOffset,e.height()-o.yOffset),anchor:"center",align:"center",font:"Numbers",letterSpacing:-18}),e.drawText({text:"SCORE",size:8,pos:e.vec2(e.center().x+o.xOffset,e.height()-o.yOffset-12),anchor:"center",align:"center",letterSpacing:-2,opacity:.5})):o.mode=="over"&&e.go("over")})});e.scene("menu",t=>{e.onDraw(()=>{e.drawSprite({sprite:"TITLE",anchor:"center",pos:e.vec2(e.center().x,e.center().y+16)}),e.drawText({text:"10   %",size:10,width:120,anchor:"center",align:"center",letterSpacing:-2,pos:e.vec2(e.center().x,e.center().y-16)})})});const o={yOffset:T(),xOffset:window.screen.orientation.type.includes("landscape")?64:36,xPosition:e.center().x,spacing:8,particles:null,mode:"start",score:0,highscore:0,enemiesBeaten:0};e.setLayers(["background","game","foreground"],"foreground");e.onLoad(()=>{e.randSeed(Date.now()),e.go("game")});
//# sourceMappingURL=index-B7a5KgUl.js.map
