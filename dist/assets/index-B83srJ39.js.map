{"version":3,"file":"index-B83srJ39.js","sources":["../../src/loader.js","../../src/utils/utils.js","../../src/kaplay.js","../../src/scenes/lose.js","../../src/utils/animations.js","../../src/components/charactergui.js","../../src/objects/hero.js","../../src/utils/difficulty.js","../../src/objects/shields.js","../../src/objects/enemy.js","../../src/scenes/game.js","../../src/scenes/menu.js","../../src/main.js"],"sourcesContent":["import { k } from \"./kaplay\";\n\nexport function loadAssets() {\n  k.loadRoot(\"./\"); // A good idea for Itch.io publishing later\n\n  k.loadBitmapFont(\"Alkhemikal\", \"fonts/Alkhemikal.png\", 24, 32, {\n    filter: \"nearest\",\n    chars:\n      \" !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",\n  });\n\n  k.loadBitmapFont(\"NameHere\", \"fonts/NameHere.png\", 24, 32, {\n    filter: \"nearest\",\n    chars:\n      \" !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\",\n  });\n\n  k.loadBitmapFont(\"Numbers\", \"fonts/Number.png\", 30, 30, {\n    filter: \"nearest\",\n    chars: \" #$%'()*+,-./0123456789:<=>\",\n  });\n\n  k.loadBitmapFont(\"Classic\", \"fonts/ClassicShit.png\", 30, 30, {\n    filter: \"nearest\",\n    chars:\n      \" !&'()*+,.0123456789:;=?ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\",\n  });\n\n  k.loadFont(\"Menu\", \"fonts/MenuCard.ttf\");\n\n  k.loadSprite(\"TITLE\", \"sprites/title.png\");\n}\n","import { k } from \"../kaplay\";\n\nexport function getOffsetPosition(defaultOffset = 48) {\n  let offset = defaultOffset;\n\n  const maxDistance = 128;\n  const playArea = k.height() - offset * 2;\n\n  if (playArea > maxDistance) {\n    const areaDifference = playArea - maxDistance;\n\n    offset = offset + areaDifference / 2;\n  }\n\n  return offset;\n}\n","import kaplay from \"kaplay\";\nimport { loadAssets } from \"./loader\";\nimport { getOffsetPosition } from \"./utils/utils\";\n\n// import \"kaplay/global\"; // uncomment if you want to use without the k. prefix\n\nexport const k = kaplay({\n  global: false,\n  //width: 240,\n  //height: 208,\n  scale: 4,\n  font: \"NameHere\",\n  crisp: true,\n  texFilter: \"nearest\",\n  loadingScreen: true,\n  background: [10, 10, 20],\n  debug: true,\n  buttons: {\n    primary: {\n      keyboard: [\"x\", \"up\"],\n      gamepad: [\"south\"],\n      mouse: [\"left\"],\n    },\n    secondary: {\n      keyboard: [\"z\", \"left\"],\n      gamepad: [\"west\"],\n      mouse: [\"right\"],\n    },\n  },\n});\n\nexport const GameState = {\n  difficulty: k.choose([\"easy\", \"medium\", \"hard\"]),\n  mode: \"start\",\n  score: 0,\n  highscore: 0,\n  yOffset: getOffsetPosition(),\n  xOffset: 64,\n  xPosition: k.center().x,\n  spacing: 6,\n  tintColor: [244, 78, 56],\n};\n\nk.onResize(() => {\n  GameState.yOffset = getOffsetPosition();\n  GameState.xPosition = k.center().x;\n});\n\nloadAssets();\n\nk.loadShader(\n  \"tint\",\n  null,\n  `\n  uniform vec3 u_color;\n\n  vec4 frag(vec2 pos, vec2 uv, vec4 color, sampler2D tex) {\n      vec4 c = def_frag();\n      return vec4(u_color.x * c.r,\n        u_color.y * c.g,\n        u_color.z * c.b,\n        c.a);\n  }\n`,\n);\n\nconst colorPalettes = [\n  [139, 200, 254],\n  [207, 171, 74],\n  [244, 78, 56],\n  [0, 255, 174],\n  [166, 146, 176],\n];\n\nconst colorHistory = [];\n\nexport function setTintColor() {\n  // available indices that are not in last 2\n  const options = colorPalettes\n    .map((_, i) => i)\n    .filter((i) => !colorHistory.includes(i));\n\n  // pick a random index\n  const colorIndex = options[Math.floor(Math.random() * options.length)];\n\n  // update history\n  colorHistory.push(colorIndex);\n  if (colorHistory.length > 2) colorHistory.shift();\n\n  // store raw RGB in GameState\n  GameState.tintColor = colorPalettes[colorIndex];\n\n  const [r, g, b] = colorPalettes[colorIndex].map((v) => v / 255);\n\n  k.usePostEffect(\"tint\", () => ({\n    u_color: k.rgb(r, g, b),\n  }));\n}\n\n// set initial color\nsetTintColor();\n\nk.onLoading((progress) => {\n  k.randSeed(Date.now());\n\n  /*k.drawSprite({\n    sprite: \"TITLE\",\n    anchor: \"center\",\n    pos: k.vec2(k.center().x, k.center().y + 16),\n  });*/\n\n  k.drawText({\n    text: (Math.floor(progress) + \" %\").toString(),\n    size: 10,\n    width: 120,\n    anchor: \"center\",\n    align: \"center\",\n    letterSpacing: -2,\n    pos: k.center(),\n    color: k.WHITE,\n  });\n});\n","import { k, GameState } from \"../kaplay\";\n\nk.scene(\"over\", () => {\n  const restart = k.add([\n    k.sprite(\"restart\"),\n    k.pos(k.center().x, k.center().y + 48),\n    k.anchor(\"center\"),\n    k.area(),\n    \"restart\",\n  ]);\n\n  if (GameState.score > GameState.highscore)\n    GameState.highscore = GameState.score;\n\n  k.onClick(\"restart\", () => {\n    GameState.score = 0;\n    GameState.mode = \"start\";\n    k.go(\"game\");\n  });\n\n  k.onDraw(() => {\n    k.drawSprite({\n      sprite: \"RIP\",\n      width: 24,\n      height: 24,\n      pos: k.vec2(k.center().x, k.center().y - 64),\n      anchor: \"center\",\n    });\n\n    k.drawText({\n      text: \"GAME OVER\",\n      font: \"Alkhemikal\",\n      anchor: \"center\",\n      align: \"center\",\n      pos: k.vec2(k.center().x, k.center().y - 26),\n      letterSpacing: -4,\n      size: 28,\n    });\n\n    k.drawText({\n      text: \"Score: \" + GameState.score,\n      anchor: \"center\",\n      align: \"center\",\n      pos: k.center(),\n      letterSpacing: -5,\n      size: 16,\n    });\n\n    k.drawText({\n      text: \"Highscore: \" + GameState.highscore,\n      anchor: \"center\",\n      align: \"center\",\n      pos: k.vec2(k.center().x, k.center().y + 16),\n      letterSpacing: -5,\n      size: 16,\n    });\n\n    k.drawText({\n      text: \"by FABRIC VISIONS\",\n      anchor: \"center\",\n      align: \"center\",\n      pos: k.vec2(k.center().x, k.height() - 10),\n      letterSpacing: -2.8,\n      size: 8,\n      opacity: 0.4,\n    });\n  });\n});\n","import { k } from \"../kaplay\";\n\nexport function animateFadeToSpriteChange(sprite) {\n  k.tween(1, 0, 2, (p) => (opacityWaving = p), k.easings.linear).onEnd(() => {\n    if (controlSchemeFrame + 1 > k.getSprite(\"inputs\").frames) {\n      controlSchemeFrame = 0;\n    } else {\n      controlSchemeFrame += 1;\n    }\n    k.tween(0, 1, 2, (p) => (opacityWaving = p), k.easings.linear).onEnd(() => {\n      animateFadeToSpriteChange(sprite);\n    });\n  });\n}\n\nexport function animateShakingObject(obj, duration = 0.2, intensity = 3) {\n  const startX = obj.pos.x;\n\n  obj.tween(\n    0,\n    1,\n    duration,\n    (t) => {\n      // t goes from 0 â†’ 1 over `duration`\n      // multiply by frequency to get N oscillations per second\n      const angle = t * 10 * Math.PI * 2 * duration;\n      obj.pos.x = startX + Math.sin(angle) * intensity;\n    },\n    k.easings.easeOutCubic,\n  );\n}\n\nexport function animateFloatingObject(obj) {\n  obj.animate(\"pos\", [k.vec2(0), k.vec2(0, 2)], {\n    duration: 1,\n    direction: \"ping-pong\",\n    easing: k.easings.easeInOutSine,\n  });\n}\n\nexport function animateSquashStretchObject(obj) {\n  obj.tween(\n    k.vec2(0.6, 1.2),\n    k.vec2(1),\n    1,\n    (value) => {\n      obj.scale = value;\n    },\n    k.easings.easeOutElastic,\n  );\n}\n","import { k } from \"../kaplay\";\nimport { animateSquashStretchObject } from \"../utils/animations\";\n\nexport function buildGUI(OPTIONS, number, maxNumber, mirror = false) {\n  const dir = mirror ? -1 : 1;\n\n  k.drawSprite({\n    sprite: \"diamond\",\n    pos: k.vec2(OPTIONS.xOffset * dir, 0),\n    anchor: \"center\",\n    flipX: mirror,\n  });\n\n  k.drawText({\n    text: number.toString(),\n    size: 14,\n    pos: k.vec2(OPTIONS.xOffset * dir + 0.3, -0.5),\n    anchor: \"center\",\n    align: \"center\",\n    font: \"Numbers\",\n    letterSpacing: -10,\n  });\n\n  // Sprites in a zig-zag way\n  for (let i = 0; i < maxNumber; i++) {\n    // base position\n    const baseX = dir * (OPTIONS.xOffset + 11);\n    const baseY = i * OPTIONS.spacing + 6;\n\n    // every odd index nudges X by a certain amount\n    const zigzagOffset = i % 2 === 0 ? 0 : OPTIONS.spacing;\n\n    k.drawSprite({\n      sprite: \"point\",\n      frame: i < number ? 0 : 1,\n      opacity: i < number ? 1 : 0.5,\n      pos: k.vec2(baseX - dir * zigzagOffset, dir * baseY),\n      anchor: \"center\",\n      flipY: !mirror,\n      flipX: !mirror,\n    });\n  }\n}\n","import { k, GameState } from \"../kaplay\";\nimport {\n  animateFloatingObject,\n  animateSquashStretchObject,\n} from \"../utils/animations\";\nimport { buildGUI } from \"../components/charactergui\";\n\nexport function hero() {\n  // PARENT OBJECT\n  const object = k.add([\n    k.pos(GameState.xPosition, k.height() - GameState.yOffset),\n    k.anchor(\"center\"),\n    k.layer(\"game\"),\n    {\n      canShoot: false,\n      reloadSpeed: 10,\n      bulletSpeed: 3,\n      ammo: 5,\n      maxAmmo: 0,\n    },\n    \"player\",\n  ]);\n\n  object.maxAmmo = object.ammo;\n\n  // SPRITE ONLY SETUP\n  const sprite = object.add([\n    k.sprite(\"hero\"),\n    k.pos(),\n    k.animate({ relative: true }),\n    k.layer(\"game\"),\n    k.z(1),\n    k.anchor(\"center\"),\n    k.timer(),\n  ]);\n\n  animateFloatingObject(sprite);\n\n  // DRAW PLAYER AMMO\n  object.onDraw(() => {\n    if (GameState.mode !== \"game\") return;\n\n    buildGUI(GameState, object.ammo, object.maxAmmo, true);\n  });\n\n  // SHOOT PROJECTILE FUNCTION\n  // Creates a bullet\n  object.shoot = () => {\n    if (object.ammo > 0 && object.canShoot) {\n      object.ammo -= 1;\n      object.canShoot = false;\n\n      k.wait(0.1 * object.reloadSpeed, () => {\n        object.canShoot = true;\n      });\n\n      sprite.unanimate(\"pos\");\n      animateSquashStretchObject(sprite);\n\n      const bullet = k.add([\n        k.pos(object.pos),\n        k.sprite(\"bullet\", { anim: \"play\" }),\n        k.area({ scale: 0.4 }),\n        k.offscreen({ destroy: true }),\n        k.anchor(\"center\"),\n        k.layer(\"game\"),\n        k.move(k.UP, object.bulletSpeed * 30),\n        \"bullet\",\n      ]);\n\n      function collide() {\n        bullet.unuse(\"move\");\n\n        bullet.sprite = \"hit\";\n        bullet.play(\"play\");\n\n        bullet.onAnimEnd((anim) => {\n          bullet.destroy();\n        });\n      }\n\n      bullet.onCollide(\"shield\", () => {\n        collide();\n      });\n\n      bullet.onCollide(\"crown\", () => {\n        collide();\n      });\n\n      animateFloatingObject(sprite);\n    }\n  };\n\n  return object;\n}\n","// difficulties.js\nimport { k } from \"../kaplay\";\n\nconst DIFFICULTIES = {\n  TEST: {\n    health: () => 1,\n    shields: () => 1,\n    radius: () => 40,\n    speed: () => 0.3,\n    score: () => k.randi(8, 11),\n  },\n  easy: {\n    health: () => k.randi(3, 5),\n    shields: () => k.randi(3, 5),\n    radius: () => 40,\n    speed: () => k.rand(0.45, 0.7),\n    score: () => 3,\n  },\n  medium: {\n    health: () => k.randi(4, 6),\n    shields: () => k.randi(4, 6),\n    radius: () => 36,\n    speed: () => k.rand(1.1, 1.2),\n    score: () => k.randi(5, 8),\n  },\n  hard: {\n    health: () => k.randi(6, 9),\n    shields: () => k.randi(5, 7),\n    radius: () => 36,\n    speed: () => k.rand(1.4, 1.5),\n    score: () => k.randi(9, 12),\n  },\n  imposible: {\n    health: () => k.randi(9, 11),\n    shields: () => k.randi(6, 8),\n    radius: () => 32,\n    speed: () => k.rand(1.7, 1.8),\n    score: () => 16,\n  },\n};\n\nexport function getEnemyConfig(difficulty = \"easy\") {\n  const rules = DIFFICULTIES[difficulty];\n\n  return {\n    health: rules.health(),\n    shields: rules.shields(),\n    radius: rules.radius(),\n    speed: rules.speed(),\n    score: rules.score(),\n  };\n}\n","import { k } from \"../kaplay\";\nimport { animateSquashStretchObject } from \"../utils/animations\";\n\n// helper: linear interpolation between 2 vectors\nfunction lerpVec(a, b, t) {\n  return k.vec2(a.x + (b.x - a.x) * t, a.y + (b.y - a.y) * t);\n}\n\n// Path generators\nfunction circlePath(t, i, count, radius) {\n  const angle = ((2 * Math.PI) / count) * i + t;\n  return k.vec2(Math.cos(angle) * radius, Math.sin(angle) * radius);\n}\n\nfunction squarePath(t, i, count, radius) {\n  // normalize shield position along square perimeter\n  const progress = (i / count + t * 0.1) % 1; // 0..1 looping\n  const side = Math.floor(progress * 4); // 0,1,2,3\n  const local = (progress * 4) % 1;\n\n  switch (side) {\n    case 0:\n      return k.vec2(-radius + 2 * radius * local, -radius);\n    case 1:\n      return k.vec2(radius, -radius + 2 * radius * local);\n    case 2:\n      return k.vec2(radius - 2 * radius * local, radius);\n    case 3:\n      return k.vec2(-radius, radius - 2 * radius * local);\n  }\n}\n\nfunction trianglePath(t, i, count, radius) {\n  let progress = (i / count + t * 0.1) % 1;\n  if (progress >= 1) progress = 0;\n\n  const raw = progress * 3;\n  let side = Math.floor(raw);\n  if (side >= 3) side = 2; // clamp safeguard\n  const local = raw - side;\n\n  const h = Math.sqrt(3) * radius;\n\n  const vertices = [\n    k.vec2(0, -h / 2),\n    k.vec2(-radius, h / 2),\n    k.vec2(radius, h / 2),\n  ];\n\n  const a = vertices[side];\n  const b = vertices[(side + 1) % 3];\n\n  return lerpVec(a, b, local);\n}\n\nexport function shieldSetup(object) {\n  const path = \"circle\";\n  const spriteFrame = k.randi(7);\n  const spriteFlip = spriteFrame != 4 && k.rand() < 0.5 ? true : false;\n\n  // SHIELDS SETUP\n  // And onUpdate constant movement/animation\n  for (let i = 0; i < object.shields; i++) {\n    const newShield = k.add([\n      k.sprite(\"shield\", {\n        frame: spriteFrame,\n        flipX: spriteFlip,\n      }),\n      k.anchor(\"center\"),\n      k.area({ scale: k.vec2(0.65, 0.5), offset: k.vec2(0, 1.4) }),\n      k.pos(object.pos),\n      k.layer(\"game\"),\n      k.timer(),\n      k.z(1),\n      \"shield\",\n    ]);\n\n    newShield.onCollide(\"bullet\", () => {\n      animateSquashStretchObject(newShield);\n    });\n\n    // store index, not offset\n    object.createdShields.push({ shield: newShield, index: i });\n  }\n\n  object.onUpdate(() => {\n    if (!object.has(\"health\")) return;\n\n    const t = k.time() * object.speed * object.direction;\n    let offset = k.vec2(0, 0);\n\n    object.createdShields.forEach(({ shield, index }) => {\n      switch (path) {\n        case \"circle\":\n          offset = circlePath(t, index, object.shields, object.radius);\n          break;\n        case \"square\":\n          offset = squarePath(t, index, object.shields, object.radius);\n          break;\n        case \"triangle\":\n          offset = trianglePath(t, index, object.shields, object.radius);\n          break;\n      }\n      shield.moveTo(object.pos.x + offset.x, object.pos.y + offset.y);\n    });\n  });\n\n  object.onDeath(() => {\n    object.createdShields.forEach(({ shield }, i) => {\n      k.wait(0.3 * i, () => {\n        shield.sprite = \"explode\";\n        shield.play(\"play\");\n\n        shield.onAnimEnd((anim) => {\n          shield.destroy();\n        });\n      });\n    });\n  });\n}\n","import { buildGUI } from \"../components/charactergui\";\nimport { k, GameState } from \"../kaplay\";\nimport {\n  animateFloatingObject,\n  animateShakingObject,\n  animateSquashStretchObject,\n} from \"../utils/animations\";\nimport { getEnemyConfig } from \"../utils/difficulty\";\nimport { shieldSetup } from \"./shields\";\n\nexport function enemy() {\n  const stats = getEnemyConfig(GameState.difficulty);\n\n  // PARENT OBJECT\n  const object = k.add([\n    k.health(stats.health),\n    k.pos(GameState.xPosition, GameState.yOffset + 5),\n    k.area({ shape: new k.Rect(k.vec2(0), 16, 16) }),\n    k.anchor(\"center\"),\n    k.layer(\"game\"),\n    k.particles(\n      {\n        max: 100,\n        speed: [60, 80],\n        damping: [2.0, 3.0],\n        lifeTime: [0.85, 1.2],\n        angle: [0, 360],\n        texture: k.getSprite(\"hit\").data.tex, // texture of a sprite\n        quads: [\n          k.getSprite(\"hit\").data.frames[0],\n          k.getSprite(\"explode\").data.frames[1],\n          k.getSprite(\"explode\").data.frames[0],\n        ], // frames of a sprite\n      },\n      {\n        direction: 0,\n        spread: 360,\n      },\n    ),\n    {\n      shields: stats.shields,\n      radius: stats.radius,\n      speed: stats.speed,\n      score: stats.score,\n      direction: k.rand() < 0.5 ? 1 : -1,\n      createdShields: [],\n    },\n    \"crown\",\n  ]);\n\n  // SPRITE ONLY SETUP\n  const sprite = object.add([\n    k.sprite(\"crown\"),\n    k.pos(),\n    k.anchor(\"center\"),\n    k.animate({ relative: true }),\n    k.timer(),\n  ]);\n\n  animateFloatingObject(sprite);\n\n  // DRAW ENEMY HEALTH\n  object.onDraw(() => {\n    if (GameState.mode !== \"game\" || !object.has(\"health\")) return;\n\n    buildGUI(GameState, object.hp, object.maxHP);\n  });\n\n  shieldSetup(object);\n\n  object.onCollide(\"bullet\", () => {\n    animateShakingObject(sprite);\n    animateSquashStretchObject(sprite);\n    object.hp -= 1;\n  });\n\n  object.onDeath(() => {\n    object.unuse(\"health\");\n    k.shake(4);\n\n    const timer = 0.25 * object.createdShields.length + 1;\n\n    animateShakingObject(sprite, timer, 2);\n\n    k.loop(\n      0.25,\n      () => {\n        object.emit(4);\n      },\n      object.createdShields.length + 1,\n    );\n\n    k.tween(\n      GameState.score,\n      (GameState.score += object.score),\n      timer,\n      (p) => (GameState.score = Math.ceil(p)),\n      k.easings.easeOutQuint,\n    );\n\n    k.wait(timer, () => {\n      k.shake(2);\n      object.destroy();\n    });\n  });\n\n  return object;\n}\n","import { k, GameState, setTintColor } from \"../kaplay\";\nimport \"./lose\";\nimport { hero } from \"../objects/hero\";\nimport { enemy } from \"../objects/enemy\";\nimport { getOffsetPosition } from \"../utils/utils\";\n\nk.scene(\"game\", () => {\n  k.onResize(() => {\n    GameState.yOffset = getOffsetPosition();\n    GameState.xPosition = k.center().x;\n  });\n\n  function setBackgroundPosition() {\n    return k.vec2(k.randi(4, 32 - wid - 4), k.randi(4, 32 - wid - 4));\n  }\n\n  let bg = \"bg\" + 0;\n  const wid = Math.floor(k.width() / 16 / 2);\n  let bgPos = setBackgroundPosition();\n\n  const bgItem = k.add([\n    //k.sprite(bg.toString()),\n    k.layer(\"background\"),\n  ]);\n\n  bgItem.onDraw(() => {\n    k.drawSprite({\n      sprite: bg.toString(),\n      pos: k.vec2(bgPos.x * -16, bgPos.y * -16),\n      //anchor: \"center\",\n    });\n  });\n\n  const player = hero();\n  player.canShoot = true;\n\n  const pos = k.vec2(k.center().x + GameState.xOffset, player.pos.y);\n\n  let enemy_obj = enemy();\n\n  k.onDestroy(\"crown\", () => {\n    k.wait(0.25, () => {\n      enemy_obj = enemy();\n      setTintColor();\n    });\n  });\n\n  k.onCollide(\"crown\", \"bullet\", (crown, bullet) => {\n    k.shake(1);\n    player.ammo += 1;\n  });\n\n  k.onCollide(\"shield\", \"bullet\", (shield, bullet) => {\n    k.shake(1);\n  });\n\n  k.onUpdate(() => {\n    if (player.ammo === 0 && k.get(\"bullet\").length <= 0) {\n      //console.log(\"loser\");\n      GameState.mode = \"over\";\n    }\n  });\n\n  function shootProjectile() {\n    if (GameState.mode === \"start\") {\n      GameState.mode = \"game\";\n    } else {\n      player.shoot();\n    }\n  }\n\n  k.onButtonPress(\"secondary\", () => {\n    //player.maxAmmo += 1;\n    //player.ammo = player.maxAmmo;\n    setTintColor();\n    bgPos = setBackgroundPosition();\n  });\n\n  k.onButtonDown(\"primary\", () => {\n    shootProjectile();\n  });\n\n  let opacityWaving = 1;\n  let controlSchemeFrame = 0;\n  function animateFadeToSpriteChange() {\n    k.tween(\n      1,\n      0,\n      1,\n      (p) => (opacityWaving = p),\n      k.easings.easeInOutCubic,\n    ).onEnd(() => {\n      if (controlSchemeFrame == k.getSprite(\"inputs\").data.frames.length - 1) {\n        controlSchemeFrame = 0;\n      } else {\n        controlSchemeFrame += 1;\n      }\n      k.tween(\n        0,\n        1,\n        1,\n        (p) => (opacityWaving = p),\n        k.easings.easeInOutCubic,\n      ).onEnd(() => {\n        k.wait(3, () => {\n          animateFadeToSpriteChange();\n        });\n      });\n    });\n  }\n\n  k.wait(4, () => {\n    animateFadeToSpriteChange();\n  });\n\n  k.onDraw(() => {\n    if (GameState.mode == \"start\") {\n      /*k.drawSprite({\n        sprite: \"TITLE\",\n        pos: k.center(),\n        anchor: \"center\",\n      });*/\n\n      /*k.drawText({\n        text: \"CROWNFALL\",\n        anchor: \"center\",\n        align: \"center\",\n        pos: k.center(),\n        size: 32,\n        font: \"Alkhemikal\",\n        letterSpacing: -4,\n      });*/\n\n      k.drawSprite({\n        sprite: \"inputs\",\n        pos: k.vec2(k.center().x - 7.7, k.center().y + 20),\n        opacity: opacityWaving,\n        frame: controlSchemeFrame,\n        anchor: \"center\",\n      });\n\n      k.drawText({\n        text: \"Press     to shoot\",\n        anchor: \"center\",\n        align: \"center\",\n        pos: k.vec2(k.center().x, k.center().y + 20),\n        letterSpacing: -5,\n        //font: \"Menu\",\n        size: 14,\n      });\n\n      k.drawText({\n        text: \"by FABRIC VISIONS\",\n        anchor: \"center\",\n        align: \"center\",\n        pos: k.vec2(k.center().x, k.center().y + 92),\n        letterSpacing: -2.8,\n        size: 8,\n        opacity: 0.4,\n      });\n    } else if (GameState.mode == \"game\") {\n      if (GameState.score > 0) {\n        // SCORE TEXT\n        k.drawText({\n          text: String(GameState.score).padStart(2, \"0\"),\n          size: 28,\n          pos: k.vec2(pos.x, pos.y - 6),\n          anchor: \"center\",\n          align: \"center\",\n          font: \"Numbers\",\n          letterSpacing: -18,\n        });\n\n        k.drawText({\n          text: \"SCORE\",\n          size: 8,\n          pos: k.vec2(pos.x - 0.4, pos.y + 6),\n          anchor: \"center\",\n          align: \"center\",\n          letterSpacing: -2,\n          opacity: 0.5,\n        });\n      }\n    } else if (GameState.mode == \"over\") {\n      k.go(\"over\");\n    }\n  });\n});\n","import { k } from \"../kaplay\";\n\nk.scene(\"menu\", (opts) => {\n  k.onDraw(() => {\n    k.drawSprite({\n      sprite: \"TITLE\",\n      anchor: \"center\",\n      pos: k.vec2(k.center().x, k.center().y + 16),\n    });\n\n    k.drawText({\n      text: \"10   %\",\n      size: 10,\n      width: 120,\n      anchor: \"center\",\n      align: \"center\",\n      letterSpacing: -2,\n      pos: k.vec2(k.center().x, k.center().y - 16),\n    });\n  });\n});\n","import { k } from \"./kaplay\";\nimport \"./scenes/game\";\nimport \"./scenes/menu\";\n\nk.loadSpriteAtlas(\"sprites/gui-sheet.png\", {\n  diamond: {\n    x: 0,\n    y: 0,\n    width: 16,\n    height: 16,\n  },\n  point: {\n    x: 32,\n    y: 0,\n    width: 32,\n    height: 16,\n    sliceX: 2,\n  },\n  RIP: {\n    x: 0,\n    y: 16,\n    width: 16,\n    height: 16,\n  },\n  border: {\n    x: 16,\n    y: 0,\n    width: 16,\n    height: 16,\n    slice9: {\n      left: 2,\n      right: 2,\n      top: 2,\n      bottom: 2,\n    },\n  },\n  restart: {\n    x: 16,\n    y: 16,\n    width: 16,\n    height: 16,\n  },\n  inputs: {\n    x: 0,\n    y: 32,\n    width: 80,\n    height: 16,\n    sliceX: 5,\n  },\n});\n\nk.loadSpriteAtlas(\"sprites/tileset.png\", {\n  hero: {\n    x: 16,\n    y: 0,\n    width: 16,\n    height: 16,\n  },\n  bullet: {\n    x: 32,\n    y: 0,\n    width: 32,\n    height: 16,\n    sliceX: 2,\n    anims: {\n      play: {\n        from: 0,\n        to: 1,\n        loop: true,\n      },\n    },\n  },\n  crown: {\n    x: 0,\n    y: 0,\n    width: 16,\n    height: 16,\n  },\n  shield: {\n    x: 0,\n    y: 16,\n    width: 64,\n    height: 32,\n    sliceX: 4,\n    sliceY: 2,\n  },\n});\n\nk.loadSpriteAtlas(\"sprites/fx-sheet.png\", {\n  explode: {\n    x: 0,\n    y: 0,\n    width: 96,\n    height: 16,\n    sliceX: 6,\n    anims: {\n      play: {\n        from: 0,\n        to: 5,\n        speed: 12,\n      },\n    },\n  },\n  hit: {\n    x: 0,\n    y: 16,\n    width: 64,\n    height: 16,\n    sliceX: 4,\n    anims: {\n      play: {\n        from: 0,\n        to: 3,\n        speed: 12,\n      },\n    },\n  },\n  particle: {\n    x: 64,\n    y: 16,\n    width: 32,\n    height: 16,\n    sliceX: 2,\n  },\n});\n\nk.loadSprite(\"bg0\", \"map/backgrounds/png/Level_0.png\");\n\nk.setLayers([\"background\", \"game\", \"foreground\", \"shader\"], \"shader\");\n\nk.onLoad(() => {\n  k.go(\"game\");\n});\n"],"names":["loadAssets","k","getOffsetPosition","defaultOffset","offset","maxDistance","playArea","areaDifference","kaplay","GameState","colorPalettes","colorHistory","setTintColor","options","_","i","colorIndex","r","g","b","v","progress","animateShakingObject","obj","duration","intensity","startX","t","angle","animateFloatingObject","animateSquashStretchObject","value","buildGUI","OPTIONS","number","maxNumber","mirror","dir","baseX","baseY","zigzagOffset","hero","object","sprite","collide","bullet","anim","DIFFICULTIES","getEnemyConfig","difficulty","rules","lerpVec","a","circlePath","count","radius","squarePath","side","local","trianglePath","raw","h","vertices","shieldSetup","path","spriteFrame","spriteFlip","newShield","shield","index","enemy","stats","timer","p","setBackgroundPosition","wid","bg","bgPos","player","pos","crown","shootProjectile","opacityWaving","controlSchemeFrame","animateFadeToSpriteChange","opts"],"mappings":"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"}